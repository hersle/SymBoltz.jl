<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Observable quantities · SymBoltz</title><meta name="title" content="Observable quantities · SymBoltz"/><meta property="og:title" content="Observable quantities · SymBoltz"/><meta property="twitter:title" content="Observable quantities · SymBoltz"/><meta name="description" content="Documentation for SymBoltz."/><meta property="og:description" content="Documentation for SymBoltz."/><meta property="twitter:description" content="Documentation for SymBoltz."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.webp" alt="SymBoltz logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SymBoltz</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li><a class="tocitem" href="../automatic_differentiation/">Using automatic differentiation</a></li><li><a class="tocitem" href="../extended_models/">Extending models</a></li><li><a class="tocitem" href="../parameter_fitting/">Fitting parameters</a></li><li><a class="tocitem" href="../forecasting/">Fisher forecasting</a></li></ul></li><li><span class="tocitem">Building models</span><ul><li><a class="tocitem" href="../components/">Components (submodels)</a></li><li><a class="tocitem" href="../models/">Cosmologies (full models)</a></li></ul></li><li><a class="tocitem" href="../solve/">Solving models</a></li><li><a class="tocitem" href="../plot/">Plotting and visualization</a></li><li class="is-active"><a class="tocitem" href>Observable quantities</a><ul class="internal"><li><a class="tocitem" href="#Primordial-power-spectra"><span>Primordial power spectra</span></a></li><li><a class="tocitem" href="#Matter-power-spectra"><span>Matter power spectra</span></a></li><li><a class="tocitem" href="#CMB-power-spectra"><span>CMB power spectra</span></a></li><li><a class="tocitem" href="#Two-point-correlation-function"><span>Two-point correlation function</span></a></li><li><a class="tocitem" href="#Matter-density-fluctuations"><span>Matter density fluctuations</span></a></li><li><a class="tocitem" href="#Luminosity-distance"><span>Luminosity distance</span></a></li><li><a class="tocitem" href="#Sound-horizon-(BAO-scale)"><span>Sound horizon (BAO scale)</span></a></li><li><a class="tocitem" href="#Line-of-sight-integration"><span>Line-of-sight integration</span></a></li></ul></li><li><a class="tocitem" href="../comparison/">Comparison to CLASS</a></li><li><a class="tocitem" href="../benchmarks/">Performance and benchmarks</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Observable quantities</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Observable quantities</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/hersle/SymBoltz.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/hersle/SymBoltz.jl/blob/main/docs/src/observables.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Observable-quantities"><a class="docs-heading-anchor" href="#Observable-quantities">Observable quantities</a><a id="Observable-quantities-1"></a><a class="docs-heading-anchor-permalink" href="#Observable-quantities" title="Permalink"></a></h1><p>This page shows observable quantities that can be derived from solutions of the Einstein-Boltzmann system, such as power spectra and distances.</p><h2 id="Primordial-power-spectra"><a class="docs-heading-anchor" href="#Primordial-power-spectra">Primordial power spectra</a><a id="Primordial-power-spectra-1"></a><a class="docs-heading-anchor-permalink" href="#Primordial-power-spectra" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymBoltz.spectrum_primordial" href="#SymBoltz.spectrum_primordial"><code>SymBoltz.spectrum_primordial</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectrum_primordial(k, h, As, ns=1.0; kp = k_dimensionless(0.05 / u&quot;Mpc&quot;, h))</code></pre><p>Compute the primordial power spectrum</p><p class="math-container">\[P₀(k) = 2π² Aₛ (k/kₚ)^{nₛ-1} / k³\]</p><p>with spectral amplitude <code>As</code>, spectral index <code>ns</code> and pivot scale wavenumber <code>kp</code> at the wavenumber(s) <code>k</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hersle/SymBoltz.jl/blob/d191f565af8ffb93bb95d99b381b4cc97f3d29d8/src/observables/fourier.jl#L5-L13">source</a></section></article><h4 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h4><pre><code class="language-julia hljs">using SymBoltz, Unitful, UnitfulAstro, Plots
M = SymBoltz.ΛCDM()
pars = Dict(M.g.h =&gt; 0.7, M.I.As =&gt; 2e-9, M.I.ns =&gt; 0.95)
ks = 10 .^ range(-5, +1, length=100) / u&quot;Mpc&quot;
Ps = spectrum_primordial(ks, M, pars)
plot(log10.(ks*u&quot;Mpc&quot;), log10.(Ps/u&quot;Mpc^3&quot;); xlabel = &quot;log10(k/Mpc⁻¹)&quot;, ylabel = &quot;log10(P/Mpc³)&quot;)</code></pre><img src="c055447a.svg" alt="Example block output"/><h2 id="Matter-power-spectra"><a class="docs-heading-anchor" href="#Matter-power-spectra">Matter power spectra</a><a id="Matter-power-spectra-1"></a><a class="docs-heading-anchor-permalink" href="#Matter-power-spectra" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymBoltz.spectrum_matter" href="#SymBoltz.spectrum_matter"><code>SymBoltz.spectrum_matter</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectrum_matter(sol::CosmologySolution, k, τ = sol[τ][end]; species = [:c, :b, :h])</code></pre><p>Compute the power spectrum</p><p class="math-container">\[P(k,τ) = P₀(k) |Δ(k,τ)|²\]</p><p>of the total gauge-invariant overdensity</p><p class="math-container">\[Δ = δ + (3ℰ/k²) θ = (∑ₛδρ)/(∑ₛρₛ) + (3ℰ/k²) (∑ₛ(ρₛ+Pₛ)θₛ) / (∑ₛ(ρₛ+Pₛ))\]</p><p>for the given <code>species</code> at wavenumber(s) <code>k</code> and conformal time(s) <code>tau</code> (final, if omitted) from the solution <code>sol</code>. By default, the species are cold dark matter, baryons and massive neutrinos, which are matter-like at late times in the ΛCDM model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hersle/SymBoltz.jl/blob/d191f565af8ffb93bb95d99b381b4cc97f3d29d8/src/observables/fourier.jl#L31-L44">source</a></section><section><div><pre><code class="language-julia hljs">spectrum_matter(prob::CosmologyProblem, k, τ = nothing; species = [:c, :b, :h], kwargs...)</code></pre><p>Solve the problem <code>prob</code> with exact wavenumber(s) <code>k</code>, and then compute the power spectrum with the solution <code>sol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hersle/SymBoltz.jl/blob/d191f565af8ffb93bb95d99b381b4cc97f3d29d8/src/observables/fourier.jl#L76-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymBoltz.spectrum_matter_nonlinear" href="#SymBoltz.spectrum_matter_nonlinear"><code>SymBoltz.spectrum_matter_nonlinear</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectrum_matter_nonlinear(sol::CosmologySolution, k)</code></pre><p>Compute the nonlinear matter power spectrum from the cosmology solution <code>sol</code> at wavenumber(s) <code>k</code> using halofit implemented in MatterPower.jl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hersle/SymBoltz.jl/blob/d191f565af8ffb93bb95d99b381b4cc97f3d29d8/src/observables/fourier.jl#L87-L91">source</a></section></article><h4 id="Example-2"><a class="docs-heading-anchor" href="#Example-2">Example</a><a class="docs-heading-anchor-permalink" href="#Example-2" title="Permalink"></a></h4><pre><code class="language-julia hljs">using SymBoltz, Unitful, UnitfulAstro, Plots
M = SymBoltz.ΛCDM()
pars = SymBoltz.parameters_Planck18(M)
prob = CosmologyProblem(M, pars)
ks = 10 .^ range(-5, +2, length=200) / u&quot;Mpc&quot;
sol = solve(prob, ks)

# Linear power spectrum
Ps = spectrum_matter(sol, ks)
plot(log10.(ks*u&quot;Mpc&quot;), log10.(Ps/u&quot;Mpc^3&quot;); xlabel = &quot;log10(k/Mpc⁻¹)&quot;, ylabel = &quot;log10(P/Mpc³)&quot;, label = &quot;linear (SymBoltz)&quot;)

# Nonlinear power spectrum (from halofit)
Ps = spectrum_matter_nonlinear(sol, ks)
plot!(log10.(ks*u&quot;Mpc&quot;), log10.(Ps/u&quot;Mpc^3&quot;); label = &quot;non-linear (halofit)&quot;, legend_position = :bottomleft)</code></pre><img src="869d2915.svg" alt="Example block output"/><h2 id="CMB-power-spectra"><a class="docs-heading-anchor" href="#CMB-power-spectra">CMB power spectra</a><a id="CMB-power-spectra-1"></a><a class="docs-heading-anchor-permalink" href="#CMB-power-spectra" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymBoltz.spectrum_cmb" href="#SymBoltz.spectrum_cmb"><code>SymBoltz.spectrum_cmb</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectrum_cmb(ΘlAs::AbstractMatrix, ΘlBs::AbstractMatrix, P0s::AbstractVector, ls::AbstractVector, ks::AbstractVector; integrator = TrapezoidalRule(), normalization = :Cl)</code></pre><p>Compute the angular power spectrum</p><p class="math-container">\[Cₗᴬᴮ = (2/π) ∫\mathrm{d}k \, k² P₀(k) Θₗᴬ(k,τ₀) Θₗᴮ(k,τ₀)\]</p><p>for the given <code>ls</code>. If <code>normaliation == :Dl</code>, compute <span>$Dₗ = Cₗ l (l+1) / 2π$</span> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hersle/SymBoltz.jl/blob/d191f565af8ffb93bb95d99b381b4cc97f3d29d8/src/observables/angular.jl#L122-L131">source</a></section><section><div><pre><code class="language-julia hljs">spectrum_cmb(modes::AbstractVector, prob::CosmologyProblem, ls::AbstractVector; normalization = :Cl, unit = nothing, Δkτ0 = 2π/2, Δkτ0_S = 8.0, kτ0min = 0.1*ls[begin], kτ0max = 3*ls[end], u = (τ-&gt;tanh(τ)), u⁻¹ = (u-&gt;atanh(u)), Nlos = 768, integrator = TrapezoidalRule(), bgopts = (alg = Rodas4P(), reltol = 1e-9, abstol = 1e-9), ptopts = (alg = KenCarp4(), reltol = 1e-8, abstol = 1e-8), thread = true, kwargs...)</code></pre><p>Compute the CMB power spectra <code>modes</code> (<code>:TT</code>, <code>:EE</code>, <code>:TE</code> or an array thereof) <span>$C_l^{AB}$</span>&#39;s at angular wavenumbers <code>ls</code> from the cosmological solution <code>sol</code>. If <code>unit</code> is <code>nothing</code> the spectra are of dimensionless temperature fluctuations relative to the present photon temperature; while if <code>unit</code> is a temperature unit the spectra are of dimensionful temperature fluctuations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hersle/SymBoltz.jl/blob/d191f565af8ffb93bb95d99b381b4cc97f3d29d8/src/observables/angular.jl#L157-L162">source</a></section><section><div><pre><code class="language-julia hljs">spectrum_cmb(modes::AbstractVector, prob::CosmologyProblem, ls::AbstractVector, ls_interpolate_from::AbstractVector; kwargs...)</code></pre><p>Same, but compute the spectrum properly only for <code>ls_interpolate_from</code> and then interpolate the results to all <code>ls</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hersle/SymBoltz.jl/blob/d191f565af8ffb93bb95d99b381b4cc97f3d29d8/src/observables/angular.jl#L222-L226">source</a></section></article><h4 id="Example-3"><a class="docs-heading-anchor" href="#Example-3">Example</a><a class="docs-heading-anchor-permalink" href="#Example-3" title="Permalink"></a></h4><pre><code class="language-julia hljs">using SymBoltz, Unitful, UnitfulAstro, Plots
M = SymBoltz.ΛCDM()
pars = SymBoltz.parameters_Planck18(M)
prob = CosmologyProblem(M, pars)
ls = 10:5:1500

Dls = spectrum_cmb([:TT, :EE, :TE], prob, ls; normalization = :Dl, unit = u&quot;μK&quot;)
pTT = plot(ls, Dls[:, 1]; ylabel = &quot;Dₗᵀᵀ&quot;)
pEE = plot(ls, Dls[:, 2]; ylabel = &quot;Dₗᴱᴱ&quot;)
pTE = plot(ls, Dls[:, 3]; ylabel = &quot;Dₗᵀᴱ&quot;, xlabel = &quot;l&quot;)
plot(pTT, pEE, pTE, layout = (3, 1), size = (600, 700), legend = nothing)</code></pre><img src="4f743277.svg" alt="Example block output"/><h2 id="Two-point-correlation-function"><a class="docs-heading-anchor" href="#Two-point-correlation-function">Two-point correlation function</a><a id="Two-point-correlation-function-1"></a><a class="docs-heading-anchor-permalink" href="#Two-point-correlation-function" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymBoltz.correlation_function" href="#SymBoltz.correlation_function"><code>SymBoltz.correlation_function</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">correlation_function(sol::CosmologySolution; N = 2048, spline = true)</code></pre><p>Compute the two-point correlation function in real space by Fourier transforming the matter power spectrum of <code>sol</code> with <code>N</code> points the FFTLog algorithm implemented in TwoFAST. Returns <code>N</code> radii and correlation function values (e.g. <code>r</code>, <code>ξ</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hersle/SymBoltz.jl/blob/d191f565af8ffb93bb95d99b381b4cc97f3d29d8/src/observables/fourier.jl#L134-L139">source</a></section></article><h4 id="Example-4"><a class="docs-heading-anchor" href="#Example-4">Example</a><a class="docs-heading-anchor-permalink" href="#Example-4" title="Permalink"></a></h4><pre><code class="language-julia hljs">using SymBoltz, Unitful, UnitfulAstro, Plots
M = SymBoltz.ΛCDM()
pars = SymBoltz.parameters_Planck18(M)
prob = CosmologyProblem(M, pars)
ks = 10 .^ range(-5, +3, length=300) / u&quot;Mpc&quot;
sol = solve(prob, ks)
rs, ξs = correlation_function(sol)
rs = rs / (SymBoltz.k0*sol.bg.ps[:h]) * u&quot;Mpc&quot; # TODO: auto units
plot(rs, @. ξs * rs^2; xlims = (0, 200), xlabel = &quot;r&quot;, ylabel = &quot;r² ξ&quot;)</code></pre><img src="3e147d06.svg" alt="Example block output"/><h2 id="Matter-density-fluctuations"><a class="docs-heading-anchor" href="#Matter-density-fluctuations">Matter density fluctuations</a><a id="Matter-density-fluctuations-1"></a><a class="docs-heading-anchor-permalink" href="#Matter-density-fluctuations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymBoltz.variance_matter" href="#SymBoltz.variance_matter"><code>SymBoltz.variance_matter</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">variance_matter(sol::CosmologySolution, R)</code></pre><p>Compute the variance <span>$⟨δ²⟩$</span> of the <em>linear</em> matter density field with a top-hat filter with radius <code>R</code>. Wraps the implementation in MatterPower.jl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hersle/SymBoltz.jl/blob/d191f565af8ffb93bb95d99b381b4cc97f3d29d8/src/observables/fourier.jl#L112-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymBoltz.stddev_matter" href="#SymBoltz.stddev_matter"><code>SymBoltz.stddev_matter</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stddev_matter(sol::CosmologySolution, R)</code></pre><p>Compute the standard deviation <span>$√(⟨δ²⟩)$</span> of the <em>linear</em> matter density field with a top-hat filter with radius <code>R</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hersle/SymBoltz.jl/blob/d191f565af8ffb93bb95d99b381b4cc97f3d29d8/src/observables/fourier.jl#L127-L131">source</a></section></article><pre><code class="language-julia hljs">using SymBoltz, Unitful, UnitfulAstro, Plots
M = SymBoltz.ΛCDM()
pars = SymBoltz.parameters_Planck18(M)
prob = CosmologyProblem(M, pars)
ks = 10 .^ range(-5, +3, length=300) / u&quot;Mpc&quot;
sol = solve(prob, ks)

h = sol[M.g.h]
Rs = 10 .^ range(0, 2, length=100) * u&quot;Mpc&quot;
σs = stddev_matter.(sol, Rs)
plot(log10.(Rs/(u&quot;Mpc&quot;/h)), log10.(σs); xlabel = &quot;lg(R / (Mpc/h))&quot;, ylabel = &quot;lg(σ)&quot;, label = nothing)

R8 = 8 * u&quot;Mpc&quot;/h
σ8 = stddev_matter(sol, R8)
scatter!((log10(R8/(u&quot;Mpc&quot;/h)), log10(σ8)), series_annotation = text(&quot;  σ₈ = $(round(σ8; digits=3))&quot;, :left), label = nothing)</code></pre><img src="10028981.svg" alt="Example block output"/><h2 id="Luminosity-distance"><a class="docs-heading-anchor" href="#Luminosity-distance">Luminosity distance</a><a id="Luminosity-distance-1"></a><a class="docs-heading-anchor-permalink" href="#Luminosity-distance" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymBoltz.distance_luminosity" href="#SymBoltz.distance_luminosity"><code>SymBoltz.distance_luminosity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">distance_luminosity(sol::CosmologySolution, ivs = sol.bg.t, τ0 = sol[sol.prob.M.τ0])</code></pre><p>Compute luminosity distances</p><p class="math-container">\[d_L = \frac{r}{a} = \chi \, \mathrm{sinc} (\sqrt{K} (τ₀-τ)),\]</p><p>at the independent variable values <code>ivs</code> relative to the (present) time <code>τ0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hersle/SymBoltz.jl/blob/d191f565af8ffb93bb95d99b381b4cc97f3d29d8/src/observables/distances.jl#L2-L10">source</a></section></article><pre><code class="language-julia hljs">using SymBoltz, Plots
M = SymBoltz.RMΛ(K = SymBoltz.curvature(SymBoltz.metric()))
pars = Dict(
    M.r.Ω₀ =&gt; 5e-5,
    M.m.Ω₀ =&gt; 0.3,
    M.K.Ω₀ =&gt; 0.1,
    M.r.T₀ =&gt; NaN,
    M.g.h =&gt; 0.7
)
prob = CosmologyProblem(M, pars)
sol = solve(prob)

zs = 0.0:1.0:10.0
τs = SymBoltz.timeseries(sol, M.g.z, zs) # times at given redshifts
dLs = SymBoltz.distance_luminosity(sol, τs) / SymBoltz.Gpc
plot(zs, dLs; marker=:dot, xlabel=&quot;z&quot;, ylabel=&quot;dL / Gpc&quot;, label=nothing)</code></pre><img src="ac2d3625.svg" alt="Example block output"/><h2 id="Sound-horizon-(BAO-scale)"><a class="docs-heading-anchor" href="#Sound-horizon-(BAO-scale)">Sound horizon (BAO scale)</a><a id="Sound-horizon-(BAO-scale)-1"></a><a class="docs-heading-anchor-permalink" href="#Sound-horizon-(BAO-scale)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymBoltz.sound_horizon" href="#SymBoltz.sound_horizon"><code>SymBoltz.sound_horizon</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sound_horizon(sol::CosmologySolution)</code></pre><p>Cumulatively integrate the sound horizon</p><p class="math-container">\[    rₛ(τ) = ∫_0^τ dτ cₛ = ∫_0^τ \frac{dτ}{√(3(1+3ρ_b/4ρ_γ))}\]</p><p>to the time steps of the solution <code>sol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hersle/SymBoltz.jl/blob/d191f565af8ffb93bb95d99b381b4cc97f3d29d8/src/observables/distances.jl#L50-L58">source</a></section></article><pre><code class="language-julia hljs">using SymBoltz, Plots
M = SymBoltz.ΛCDM()
pars = SymBoltz.parameters_Planck18(M)
prob = CosmologyProblem(M, pars)
sol = solve(prob)
τs = sol[M.τ]
rs = sound_horizon(sol)
plot(τs, rs; xlabel = &quot;τ / H₀⁻¹&quot;, ylabel = &quot;rₛ / (c/H₀)&quot;)</code></pre><img src="eebc6889.svg" alt="Example block output"/><h2 id="Line-of-sight-integration"><a class="docs-heading-anchor" href="#Line-of-sight-integration">Line-of-sight integration</a><a id="Line-of-sight-integration-1"></a><a class="docs-heading-anchor-permalink" href="#Line-of-sight-integration" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymBoltz.los_integrate" href="#SymBoltz.los_integrate"><code>SymBoltz.los_integrate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">los_integrate(Ss::AbstractMatrix{T}, ls::AbstractVector, τs::AbstractVector, ks::AbstractVector, Rl::Function; integrator = TrapezoidalRule(), verbose = false) where {T &lt;: Real}</code></pre><p>For the given <code>ls</code> and <code>ks</code>, compute the line-of-sight-integrals</p><p class="math-container">\[Iₗ(k) = ∫dτ S(k,τ) Rₗ(k(τ₀-τ))\]</p><p>over the source function values <code>Ss</code> against the radial functions <code>Rl</code> (e.g. the spherical Bessel functions <span>$jₗ(x)$</span>). The element <code>Ss[i,j]</code> holds the source function value <span>$S(kᵢ, τⱼ)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hersle/SymBoltz.jl/blob/d191f565af8ffb93bb95d99b381b4cc97f3d29d8/src/observables/angular.jl#L57-L66">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../plot/">« Plotting and visualization</a><a class="docs-footer-nextpage" href="../comparison/">Comparison to CLASS »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Wednesday 2 July 2025 13:32">Wednesday 2 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
